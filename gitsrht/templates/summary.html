{% extends "repo.html" %}
{% import "utils.html" as utils with context %}
{% block title %}
<title>{{repo.owner.canonical_name}}/{{repo.name}} - {{cfg("sr.ht", "site-name")}} git</title>
{% endblock %}
{% block content %}
{% if repo.description %}
<div class="header-extension">
  <div class="container">
    {{ repo.description }}
  </div>
</div>
{% endif %}
<div class="container">
  <div class="row" style="margin-bottom: 1rem">
    <div class="col-md-6">
      <div class="event-list" style="margin-bottom: 0.5rem">
        {% for c in commits %}
        <div class="event">
          {{ utils.commit_event(repo, c) }}
        </div>
        {% endfor %}
      </div>
    </div>
    <div class="col-md-2">
      <h3>refs</h3>
      <dl>
        {% if default_branch %}
        <dt>{{default_branch.name[len("refs/heads/"):]}}</dt>
        <dd>
          <a href="{{url_for("repo.tree",
            owner=repo.owner.canonical_name, repo=repo.name)}}"
          >browse {{icon("caret-right")}}</a>
          <a href="{{url_for("repo.log",
            owner=repo.owner.canonical_name, repo=repo.name)}}"
          >log {{icon("caret-right")}}</a>
        </dd>
        {% endif %}
        {% if latest_tag %}
        <dt>{{ latest_tag[0][len("refs/tags/"):] }}</dt>
        <dd>
          <a href="{{url_for("repo.tree", owner=repo.owner.canonical_name,
              repo=repo.name, ref=latest_tag[0][len("refs/tags/"):])}}"
          >browse {{icon("caret-right")}}</a>
          <a href="{{url_for("repo.archive", owner=repo.owner.canonical_name,
              repo=repo.name, ref=latest_tag[0][len("refs/tags/"):])}}"
          >.tar.gz {{icon("caret-right")}}</a>
        </dd>
        {% endif %}
      </dl>
    </div>
    <div class="col-md-4">
      <h3>clone</h3>
      {% with read_only, read_write = repo|clone_urls %}
      <dl>
        <dt>read-only</dt>
        <dd><a href="{{read_only}}">{{read_only}}</a></dd>
        <dt>read/write</dt>
        <dd>{{read_write}}</dd>
      </dl>
      {% endwith %}
    </div>
  </div>
  {% if readme %}
  <div class="row">
    <div class="col-md-10">
      {{ readme }}
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
